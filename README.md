
# 东莞理工学院成绩查询工具

## 一、项目简介
本工具基于 Python 开发，用于帮助东莞理工学院学生通过学校统一身份认证系统查询课程成绩。支持**用户输入学号/密码**、**多学期成绩查询**以及**平时成绩、考试成绩、总评成绩分项展示**。代码采用模块化设计，将登录逻辑与成绩获取功能分离，提升可维护性与复用性。


## 二、主要功能
| 功能模块         | 详细说明                                                                 |
|------------------|--------------------------------------------------------------------------|
| **用户认证**     | - 通过学校 CAS 统一认证系统登录<br>- 支持密码加密传输（依赖 `encrypt.js`） |
| **成绩查询**     | - 可查询指定学年、学期的课程成绩<br>- 展示课程名称、学分、平时/考试/总评成绩 |
| **交互设计**     | - 命令行交互式输入（学号、密码、查询条件）<br>- 清晰的进度提示与错误反馈    |
| **模块化架构**   | - `login()`：独立登录模块<br>- `get_grades()`：成绩解析与展示模块           |


## 三、文件结构说明
```
.
├── cas_login.py       # 原始登录逻辑（未模块化，可忽略）
├── config.py          # 配置文件（可删除，已整合到主程序）
├── dgut_grade_checker.py  # 核心程序（包含登录、查询、主逻辑）
├── encrypt.js         # 密码加密脚本（需与主程序同级）
├── final_login.py     # 旧版本登录逻辑（可忽略）
├── grade_fetcher.py   # 旧版本成绩获取逻辑（可忽略）
├── main.py            # 旧版本主程序（可忽略）
└── try_execution.py   # 测试脚本（可忽略）
```


## 四、使用前提
1. **环境依赖**  
   - Python 3.6+  
   - 需安装以下 Python 库：  
     ```bash
     pip install requests beautifulsoup4 execjs
     ```
   - Node.js 环境（用于运行 `encrypt.js` 密码加密脚本）  

2. **权限要求**  
   - 需具备东莞理工学院统一身份认证账号（学号+密码）  
   - 确保账号已绑定教务系统，且有权限访问成绩查询页面  


## 五、使用步骤
### 1. 克隆仓库
```bash
git clone https://github.com/twj0/dgut-query-grades.git
cd dgut-query-grades
```

### 2. 运行程序
#### 方式一：直接运行主程序
```bash
python dgut_grade_checker.py
```

#### 方式二（可选）：调试模式运行
```bash
python -m pdb dgut_grade_checker.py  # 用于排查登录/解析错误
```

### 3. 交互式操作指南
1. **输入账号密码**  
   ```
   --- 东莞理工学院成绩查询器 ---
   请输入你的学号: 202XXXXXX
   请输入你的密码: **********  # 输入时不会显示字符
   ```

2. **登录进度提示**  
   ```
   [步骤 1/2] 正在尝试登录...
   [步骤 2/2] 登录成功！准备查询成绩。  # 若失败会提示“登录失败”
   ```

3. **查询成绩**  
   ```
   请输入要查询的学年 (例如: 2023): 2024
   请输入要查询的学期 (1 或 2): 1
   --- 正在获取成绩信息 ---
   正在查询 2024-2025学年 第1学期 的成绩...
   ```

4. **成绩展示示例**  
   ```
   =================================================================================
     东莞理工学院 2024-2025学年 第1学期 成绩单
   =================================================================================
   | 高等数学A(1)              | 学分: 4   | 平时: 85    | 考试: 90    | 最终成绩: 88   |
   | 大学英语(1)                | 学分: 3   | 平时: --     | 考试: 82    | 最终成绩: 82   |
   | 思想道德与法治             | 学分: 2   | 平时: 90    | 考试: 88    | 最终成绩: 89   |
   =================================================================================
   ```

5. **继续查询或退出**  
   ```
   是否继续查询其他学期? (y/n): y  # 输入 y 继续，其他键退出
   ```


## 六、常见问题与解决方案
| 问题描述                          | 解决方案                                                                 |
|-----------------------------------|--------------------------------------------------------------------------|
| **登录失败**                      | 1. 检查学号/密码是否正确<br>2. 确认网络连通性<br>3. 尝试网页端登录后再试   |
| **找不到 encrypt.js 文件**        | 确保 `encrypt.js` 与主程序在同一目录，或从仓库重新拉取代码               |
| **成绩表格解析错误**              | 可能是教务系统页面结构变更，需修改 `get_grades()` 中的表格解析逻辑       |
| **Node.js 环境缺失**              | 安装 Node.js（https://nodejs.org/），并配置环境变量                       |
| **输入格式错误**                  | 按提示输入数字（学年）和 1/2（学期），非数字输入会被自动拦截             |


## 七、贡献与反馈
1. **问题反馈**  
   欢迎通过 GitHub Issues 提交 BUG 或功能建议：  
   [https://github.com/twj0/dgut-query-grades/issues](https://github.com/twj0/dgut-query-grades/issues)

2. **代码贡献**  
   - 如需优化代码结构或新增功能，可提交 Pull Request  
   - 建议先通过 Issues 讨论方案，避免重复开发  

3. **注意事项**  
   - 本工具仅用于学习交流，请勿滥用或泄露他人账号信息  
   - 请遵守学校网络使用规范，避免高频请求对服务器造成压力  


## 八、更新日志
- **2025-06-08**：重构主程序，支持用户输入学号/密码，模块化拆分登录与查询逻辑  
- **2024-12-15**：初始版本发布，实现硬编码账号的成绩查询功能  


如果遇到问题或需要进一步说明，请随时联系仓库作者！ 🚀# 东莞理工学院成绩查询器

这个Python脚本可以帮助东莞理工学院的学生查询自己的课程成绩。它通过模拟登录学校的统一身份认证系统，然后访问教务系统获取成绩信息，并以清晰易读的格式展示出来。

## 主要功能

- 自动登录东莞理工学院统一身份认证系统
- 查询指定学期的课程成绩
- 显示课程名称、学分、平时成绩、考试成绩和最终成绩
- 支持连续查询多个学期的成绩
- 错误处理和友好的提示信息

## 安装与配置

### 环境要求

- Python 3.6+
- 安装必要的依赖库：

```bash
pip install requests beautifulsoup4 lxml
```

### 获取代码

从GitHub克隆仓库：

```bash
git clone https://github.com/twj0/dgut-query-grades.git
cd dgut-query-grades
```

## 使用方法

### 运行程序

执行主程序文件：

```bash
python dgut_grade_checker.py
```

### 操作步骤

1. 程序启动后，会提示你输入学号和密码
   
   ```
   --- 东莞理工学院成绩查询器 ---
   请输入你的学号: 
   请输入你的密码: 
   ```

2. 输入完成后，程序会尝试登录系统
   
   ```
   [步骤 1/2] 正在尝试登录...
   ```

3. 如果登录成功，程序会提示你输入要查询的学年和学期
   
   ```
   [步骤 2/2] 登录成功！准备查询成绩。
   请输入要查询的学年 (例如: 2023): 
   请输入要查询的学期 (1 或 2): 
   ```

4. 输入正确的学年和学期后，程序会查询并显示成绩信息
   
   ```
   正在查询 2023-2024学年 第1学期 的成绩...

   ================================================================================
   东莞理工学院 2023-2024学年 第1学期 成绩单
   ================================================================================
   | 高等数学(上)                    | 学分: 4.0  | 平时: 85    | 考试: 88    | 最终成绩: 87    |
   | 大学物理(上)                    | 学分: 3.5  | 平时: 90    | 考试: 85    | 最终成绩: 87    |
   | Python程序设计                  | 学分: 3.0  | 平时: 92    | 考试: 95    | 最终成绩: 94    |
   ================================================================================
   ```

5. 查询完成后，你可以选择继续查询其他学期的成绩

   ```
   是否继续查询其他学期? (y/n): 
   ```

## 注意事项

1. 你的学号和密码仅用于登录学校系统，不会被存储或传输到其他地方
2. 如果登录失败，请检查你的学号和密码是否正确
3. 如果遇到网络问题，请确保你的网络连接正常，并稍后再试
4. 程序运行需要访问以下网站：
   - https://auth.dgut.edu.cn (统一身份认证系统)
   - https://jw.dgut.edu.cn (教务系统)

## 常见问题

1. **程序提示"未在返回页面中找到成绩表格"**
   - 可能是因为该学期没有成绩数据
   - 也可能是因为登录状态失效，请重新运行程序

2. **程序运行缓慢**
   - 可能是因为学校服务器繁忙
   - 请尝试在非高峰期运行程序

3. **依赖库安装失败**
   - 请确保你的Python环境已正确配置
   - 可以尝试使用国内镜像源加速安装：
     ```bash
     pip install -i https://pypi.tuna.tsinghua.edu.cn/simple requests beautifulsoup4 lxml
     ```

## 贡献

如果你发现任何问题或有改进建议，请提交issue或pull request到GitHub仓库：https://github.com/twj0/dgut-query-grades
